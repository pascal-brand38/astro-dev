---
// Copyright (c) Pascal Brand
// MIT License

import 'swiper/css'
import 'swiper/css/autoplay'
import type { AstroSwiperOptionsType } from './index.d.ts'

type Props = AstroSwiperOptionsType

const {
  options={}
} = Astro.props;

const swiperId = 'astro-swiper-' + Math.random().toString(36).slice(2, 11)

---

<!-- Slider main container -->
<astro-swiper class={`swiper ${swiperId}`} data-options={JSON.stringify(options)} data-id={swiperId}>
  <slot/>
</astro-swiper>


<script>
  import Swiper from 'swiper'
  import { Autoplay } from 'swiper/modules'

  class AstroSwiper extends HTMLElement {
    constructor() {
      super();

      // Read the message from the data attribute.
      const options = JSON.parse(this.dataset.options || '')
      const id = this.dataset.id    // to have more than 1 swiper in a single page

      if (options.autoplay) {
        Swiper.use([Autoplay])
      }
      const swiper = new Swiper(`.${id}`, options)
    }
  }

  customElements.define('astro-swiper', AstroSwiper);
</script>
