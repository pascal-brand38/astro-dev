---
title: astro-leaflet
description:  The Astro component for leaflet

template: doc
hero:
  tagline:  The Astro component for leaflet
            <br>
            Display tile maps, with markers, lines,...
            <br>
            Enjoy Openstreet, Google maps,...
  image:
    file: ./astro-leaflet/astro-leaflet.png
  actions:
    - text: astro-leaflet
      link: https://github.com/pascal-brand38/astro-leaflet/blob/main/README.md
      icon: github
    - text: astro-leaflet
      link: https://www.npmjs.com/package/astro-leaflet
      icon: seti:npm
    - text: leaflet
      link: https://leafletjs.com/
      icon: external
---

import { Icon, Card, LinkButton } from '@astrojs/starlight/components';

import Minimal from './astro-leaflet/Minimal.astro'
import GoogleMarker from './astro-leaflet/GoogleMarker.astro'
import MarathonNewYork from './astro-leaflet/MarathonNewYork.astro'
import SelectLayer from './astro-leaflet/SelectLayer.astro'
import ImageOverlay from './astro-leaflet/ImageOverlay.astro'

import Tutorial01QuickStart from './astro-leaflet/Tutorial01QuickStart.astro'
import Tutorial02Mobile from './astro-leaflet/Tutorial02Mobile.astro'
import Tutorial06Choropleth from './astro-leaflet/Tutorial06Choropleth.astro'
import Tutorial07LayerControl from './astro-leaflet/Tutorial07LayerControl.astro'

import TestYourUrl from './astro-leaflet/TestYourUrl.astro'

## Install

```bash
npm install astro-leaflet
```

Read the full doc on
[Github](https://github.com/pascal-brand38/astro-leaflet/blob/main/README.md)

Leaflet documentation can be found on [leafletjs.com](https://www.leafletjs.com/)

In case of any problem (map not displayed,...),
please refer to the [Troubleshooting section](#Troubleshooting)




## Examples

<section id="minimal">
<Card title="Minimal" icon="pencil">
  Here is a minimal map from openstreetmap, in a single line component call: ``` <Leaflet /> ```


  <div class="not-content">
    <Minimal/>
  </div>

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/Minimal.astro" icon="external">
		Full code
	</LinkButton>

	<details>
	<summary>
	<Icon name="astro" class="inline-icon"/> Code Snippet
	</summary>

	```astro
  ---
  import { Leaflet } from "astro-leaflet";
  ---
  <Leaflet />
  ```
	</details>
</Card>
</section>

<section id="google-map-markers">
<Card title="Google Map with Markers" icon="pencil">
  An hybrid map (satellite, with country names, towns...) from Google is displayed, along
  with 2 markers (default leaflet marker on Paris, and custom marker on New York).

  The hybrid map is selected using
  (please check [following section](#SelectLayer) to list and display possible values of ```tileByName```)

  ```astro
  <Leaflet options={{ tileByName: 'Google&type=hybrid', }}/>
  ```

  which is the same as

  ```astro
  <Leaflet options={{
    tileLayer: 'https://{s}.google.com/vt/lyrs=y&hl=en&x={x}&y={y}&z={z}',
    tileLayerOptions: {
      subdomains: [ 'mt0', 'mt1', 'mt2', 'mt3' ],
      attribution: 'Map data &copy; Google',
    },
  }}/>
  ```

  The custom icon is created using the following, along with the definition
  of the css class ```myicon-name```

  ```astro
  <CreateLeafletIcon name='myicon-name' options={{className:"leaflet-icon-myicon", iconSize: [20,20]}}/>
  ```

  And the markers are added using ```<Leaflet/>``` markers

  ```astro
  markers = [
    { latlng: [48.8575299,2.3509908],  options: {title: 'Paris'} },
    { latlng: [40.7194951,-73.9985291], options: {title: 'New York', }, astroIconName:'myicon-name'}
  ]
  ```

  <div class="not-content">
    <GoogleMarker/>
  </div>

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/GoogleMarker.astro" icon="external">
		Full code
	</LinkButton>

	<details>
	<summary>
	<Icon name="astro" class="inline-icon"/> Code Snippet
	</summary>

	```astro
  ---
  import { Leaflet, CreateLeafletIcon } from "astro-leaflet";
  ---
  <CreateLeafletIcon name='myicon-name' options={{className:"leaflet-icon-myicon", iconSize: [20,20]}}/>
  <Leaflet
    tileByName: 'Google&type=hybrid',
    markers: {[
      { latlng: [48.8575299,2.3509908], options: {title: 'Paris'}},
      { latlng: [40.7194951,-73.9985291], options: {title: 'New York', }, astroIconName:'myicon-name'}
    ]}
  />

  <style is:global>
    /* class definition used to define the custom icon */
    .leaflet-icon-myicon {
      background:red;
      border:5px solid rgba(255,255,255,0.5);
      border-radius:50%;
    }
  </style>
  ```
	</details>
</Card>
</section>



<section id="SelectLayer">
<Card title="Select Layer" icon="pencil">
  Here is the map friendly name list to be given in ```tileByName0``` argument
  of ```LeafLet``` and ```TileLayer``` components.
  Click on the name to see how it renders, its description
  as well as the parameters to drive it, and how to call it in astro-leaflet.

  <div class="not-content">
    <SelectLayer/>
  </div>
</Card>
</section>




<section id="NYC-Marathon">
<Card id="toto" title="NYC Marathon" icon="pencil">
  This demonstrates:
  * Google satellite images as the main layer, and labels from Michelin
    displayed on it using ```<TileLayer>``` inside ```<LeafLet>```
  * A polyline trace - the track of the New York City Marathon -
    displayed using ```<Polyline>```
  * Automatic centering of the map using ```<FitBounds />``` inside ```<Polyline>```

  <div class="not-content">
    <MarathonNewYork />
  </div>

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/MarathonNewYork.astro" icon="external">
		Full code
	</LinkButton>

	<details>
	<summary>
	<Icon name="astro" class="inline-icon"/> Code Snippet
	</summary>

	```astro
  ---
  import { Leaflet, TileLayer, Polyline, FitBounds} from "astro-leaflet";
  import type { LatLngTuple } from 'leaflet'

  // load marathon data: list of [lat lng]
  import data from './new-york-city-marathon.json'
  ---

  <Leaflet options={{ options={{tileByName:'Google'}} }}>
    <TileLayer
      tileByName='Michelin&type=label',
      options={{ ... }} />
    <Polyline latlngs={data as LatLngTuple[]} options={{color: 'red', weight: 4,}} >
      <FitBounds />
    </Polyline>
  </Leaflet>
  ```
	</details>
</Card>
</section>



<section id="ImageOverlay">
<Card title="Image Overlay" icon="pencil">
  Work in Progress

  <div class="not-content">
    <ImageOverlay/>
  </div>

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/ImageOverlay.astro" icon="external">
		Full code
	</LinkButton>

	<details>
	<summary>
	<Icon name="astro" class="inline-icon"/> Code Snippet
	</summary>

	```astro
  Work in Progress
  ```
	</details>
</Card>
</section>


<section id="QuickStart">
<Card title="Leaflet Quick Start Guide" icon="pencil">
  [Leaflet Tutorial](https://leafletjs.com/examples/quick-start/) implemented with astro-leaflet.
  This will quickly get you started on Leaflet basics, including setting up a Leaflet map,
  working with markers, polylines and popups, and dealing with events.


	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/Tutorial01QuickStart.astro" icon="external">
		Full code
	</LinkButton>

  <div class="not-content">
    <Tutorial01QuickStart/>
  </div>

  Highlights:
  * ```\<Leaflet>``` is used with
    * ```id="map-quick-start"``` to style the height of the map
      in the ```\<style is:global>``` section
    * in order to not use a default height, ```style=""``` is provided.
      This is because a default map size is provided when neither style nor class is given.
    * ```center``` and ```zoom``` are provided
    * Note that it is not necessary to provide the tile url address as the
      default tiles comes from openstreetmap
  * ```\<Marker>```, ```\<Circle>``` and ```\<Polygon>``` are given along with ```\<Popup>```
  * The standalone ```\<Popup>``` is given with latlng.

  Dealing with event must be performed in the ```\<script>``` part:
  * when ```load``` event is fired, we are ensured all leaflet elements are created,
    including the map. The map can be retrieved using its id by calling
    <br/>
    &nbsp; &nbsp; ```const map = getMapFromId('map-quick-start')```
  * the event and popup can then be created using standard leaflet js code
</Card>
</section>


<section id="Mobile">
<Card title="Leaflet on Mobile" icon="pencil">
  [Leaflet Tutorial](https://leafletjs.com/examples/mobile/) implemented with astro-leaflet.
  Create a map tuned, and how to easily detect and use the current user location

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/Tutorial02Mobile.astro" icon="external">
		Full code
	</LinkButton>

  <div class="not-content">
    <Tutorial02Mobile/>
  </div>

  Highlights:
  * ```\<Leaflet>``` with an id to be able to get the associated map
    into the script part
  * ```/<FitWorld>``` and ```/<Locate>``` inside ```\<Leaflet>```
  * Events are dealt in the ```\<script>``` part:
    * get the map
    * catch ```locationfound``` and ```locationerror```
    * draw marker and circle around the found position

</Card>
</section>


<section id="Choropleth">
<Card title="Interactive Choropleth Map" icon="pencil">
  [Leaflet Tutorial](https://leafletjs.com/examples/layers-control/) implemented with astro-leaflet.
  This is a case study of creating a colorful interactive choropleth map of US States Population
  Density with the help of GeoJSON and some custom controls (that will hopefully convince all
  the remaining major news and government websites that do not use Leaflet yet to start doing so).

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/Tutorial06Choropleth.astro" icon="external">
		Full code
	</LinkButton>

  <div class="not-content">
    <Tutorial06Choropleth/>
  </div>

  Highlights:
  * ```\<GeoJson>``` to have US states overlayed on the map
  * ```\<Control>``` to display legend, and information on the hovered state
  * the script part contains:
    * style of hovered states
    * events to update the information on the hovered state, as well
      as another style for the hovered states
</Card>
</section>


<section id="LayerGroupsAndControl">
<Card title="Layer Groups and Layers Control" icon="pencil">
  [Leaflet Tutorial](https://leafletjs.com/examples/layers-control/) implemented with astro-leaflet.
  It will show you how to group several layers into one, and how to use the layers control to allow
  users to easily switch different layers on your map

	<LinkButton href="https://github.com/pascal-brand38/astro-dev/blob/main/src/content/docs/packages/astro-leaflet/Tutorial07LayerControl.astro" icon="external">
		Full code
	</LinkButton>

  <div class="not-content">
    <Tutorial07LayerControl/>
  </div>

  Highlights:
  * ```\<Leaflet>``` with ```noDefault={true}``` so that no default layer is added onto the map
  * ```\<ControlLayer>``` to select the layers to be displayed,
    and switch from one to another
  * ```\<BaseLayer>``` to add a ```\<TileLayer>``` onto the control as a checkbox
  * ```\<LayerGroup>``` to group ```\<Marker>```, to be able to select them all in once
  * ```\<Overlay>``` to add a ```\<LayerGroup>``` onto the control as a radio

</Card>
</section>



<section id="Troubleshooting">
<Card title="Troubleshooting" icon="pencil">

<h4> Map not displayed </h4>

If the map is not displayed, and you have the following error in the console

```
Uncaught SyntaxError: The requested module '/node_modules/leaflet/dist/leaflet-src.js?v=c7414b9d' does not provide an export named 'layerGroup' (at layergroup.ts?v=c7414b9d:1:10)
```

or

```
SyntaxError: Importing binding name 'default' cannot be resolved by star

```

then you have to add the following inside ```astro.config.mjs```:

```js
export default defineConfig({
  ...
  vite: {
    optimizeDeps: {
      include: ['leaflet'],
    }
  },
  ...
});
```

</Card>
</section>



<section id="TestYourUrl">
<Card title="Test Your Url" icon="pencil">
  Provide your favorite tile url, and see how it renders.

  <div class="not-content">
    <TestYourUrl/>
  </div>

</Card>
</section>
